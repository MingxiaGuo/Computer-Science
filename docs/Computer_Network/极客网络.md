**复杂的程序都要分层，这是程序设计的要求。**

**只要是在网络上跑的包，都是完整的。可以有下层没上层，绝对不可能有上层没下层。**

**对TCP协议来说，三次握手也好，重试也好，只要想发出去包，就要有IP层和MAC层，不然是发不出去的。**

所谓的二层设备、三层设备，都是这些设备上跑的程序不同而已。一个HTTP协议的包经过一个二层设备，二层设备收进去的是整个网络包。这里面HTTP、TCP、 IP、 MAC都有。什么叫二层设备呀，就是只把MAC头摘下来，看看到底是丢弃、转发，还是自己留着。那什么叫三层设备呢？就是把MAC头摘下来之后，再把IP头摘下来，看看到底是丢弃、转发，还是自己留着

mac地址局域网寻址，ip地网络寻址

计算机科学领域的任何问题都可以通过增加一个间接的中间层来解决，计算机整个体系从上到下都是按照严格的层次结构设计的。

分而治之，这种处理问题的方式是人类解决问题的基本方式之一，尤其针对复杂的问题更是首先会想到使用这种方式来处理。

因为ip地址是可以随时变化的，而mac地址是机器厂商给每个网卡配置的，是独一无二的，所以需要通过ip地址找到对应的mac地址再传输。并且这个过程所用的方法是ARP协议，即地址解析协议。通过广播的方式找到对应的mac地址。实际过程很复杂，因为ip地址会改变，所以同一个ip对应的mac地址也会变，需要用到其他技术来缓存，看地址是否失效，失效则需要重新使用arp广播查找mac地址

![06b355394f525c54f200d8a1af63ddea](https://static001.geekbang.org/resource/image/06/ea/06b355394f525c54f200d8a1af63ddea.jpg)

