简单网络管理协议 SNMP

### 6.7.1 网络管理的基本概念


网络管理包括对硬件、软件和人力的使用、综合与协调，以便对网络资源进行监视、测试、配置、分析、评价和控制，这样就能以合理的价格满足网络的一些需求，如实时运行性能，服务质量等。网络管理常简称为网管。网络管理并不是指对网络进行行政上的管理。



网络管理的一般模型



网络管理模型中的主要构件

管理站也常称为网络运行中心 NOC \(Network Operations Center\)，是网络管理系统的核心。管理程序在运行时就成为管理进程。管理站（硬件）或管理程序（软件）都可称为管理者\(manager\)。Manager 不是指人而是指机器或软件。网络管理员\(administrator\) 指的是人。大型网络往往实行多级管理，因而有多个管理者，而一个管理者一般只管理本地网络的设备。



被管对象\(Managed Object\)。

网络的每一个被管设备中可能有多个被管对象。被管设备有时可称为网络元素或网元。在被管设备中也会有一些不能被管的对象。



代理\(agent\)

在每一个被管设备中都要运行一个程序以便和管理站中的管理程序进行通信。这些运行着的程序叫做网络管理代理程序，或简称为代理。代理程序在管理程序的命令和控制下在被管设备上采取本地的行动。



网络管理协议

网络管理协议，简称为网管协议。需要注意的是，并不是网管协议本身来管理网络。网管协议就是管理程序和代理程序之间进行通信的规则。网络管理员利用网管协议通过管理站对网络中的被管设备进行管理。

\]

客户服务器方式

管理程序和代理程序按客户服务器方式工作。管理程序运行 SNMP 客户程序，向某个代理程序发出请求（或命令），代理程序运行 SNMP 服务器程序，返回响应（或执行某个动作）。在网管系统中往往是一个（或少数几个）客户程序与很多的服务器程序进行交互。



网络管理的基本原理

若要管理某个对象，就必然会给该对象添加一些软件或硬件，但这种“添加”必须对原有对象的影响尽量小些。



SNMP 的指导思想

SNMP 最重要的指导思想就是要尽可能简单。SNMP 的基本功能包括监视网络性能、检测分析网络差错和配置网络设备等。在网络正常工作时，SNMP 可实现统计、配置、和测试等功能。当网络出故障时，可实现各种差错检测和恢复功能。虽然 SNMP 是在 TCP/IP 基础上的网络管理协议，但也可扩展到其他类型的网络设备上。



SNMP 的管理站和委托代理

整个系统必须有一个管理站。管理进程和代理进程利用 SNMP 报文进行通信，而 SNMP 报文又使用 UDP 来传送。若网络元素使用的不是 SNMP 而是另一种网络管理协议，SNMP 协议就无法控制该网络元素。这时可使用委托代理\(proxy agent\)。委托代理能提供如协议转换和过滤操作等功能对被管对象进行管理。





SNMP 的网络管理由三个部分组成

SNMP 本身管理信息结构 SMI\(Structure of Management Information\)管理信息库 MIB\(Management Information Base\)。



SNMP

SNMP 定义了管理站和代理之间所交换的分组格式。所交换的分组包含各代理中的对象（变量）名及其状态（值）。SNMP 负责读取和改变这些数值。



SMI



SMI 定义了命名对象和定义对象类型（包括范围和长度）的通用规则，以及把对象和对象的值进行编码的规则。这样做是为了确保网络管理数据的语法和语义的无二义性。但从 SMI 的名称并不能看出它的功能。SMI 并不定义一个实体应管理的对象数目，也不定义被管对象名以及对象名及其值之间的关联。



MIB

MIB 在被管理的实体中创建了命名对象，并规定了其类型。



### 6.7.2 管理信息结构 SMI

SMI 的功能：

```
(1) 被管对象应怎样命名；


(2) 用来存储被管对象的数据类型有哪些种；


(3) 在网络上传送的管理数据应如何编码。 
```

SMI 规定所有被管对象必须在命名树上





SMI 使用 ASN.1

SMI 标准指明了所有的 MIB 变量必须使用抽象语法记法 1（ASN.1）来定义。SMI 既是 ASN.1 的子集，又是 ASN.1 的超集。ASN.1 的记法很严格，它使得数据的含义不存在任何可能的二义性。SMI 把数据类型分为两大类：简单类型和结构化类型。



基本编码规则 BER\(Basic Encoding Rule\)

ISO 在制订 ASN.1 语言的同时也为它定义了一种标准的编码方案，即基本编码规则 BER。BER 指明了每种数据类型中每个数据的值的表示。发送端用 BER 编码，可将用 ASN.1 所表述的报文转换成唯一的比特序列。接收端用 BER 进行解码，得到该比特序列所表示的 ASN.1 报文。





用 TLV 方法进行编码

把各种数据元素表示为以下三个字段组成的八位位组序列：\(1\) T 字段，即标识符八位位组\(identifier octet\)，用于标识标记。\(2\) L 字段，即长度用八位位组\(length octet\)，用于标识后面 V 字段的长度。\(3\) V 字段，即内容八位位组\(content octet\)，用于标识数据元素的值。



TLV 中的 T 字段定义数据的类型





TLV 中的 L 字段定义 V 字段的长度



TLV 中的 V 字段定义数据的值



例如，INTEGER 15，其 T 字段是02， INTEGER 类型要用 4 字节编码。最后得出 TLV 编码为 02 04 00 00 00 0F。又如 IPAddress 192.1.2.3，其 T 字段是 40，V 字段需要 4 字节表示，因此得出 IPAddress 192.1.2.3 的 TLV 编码是 40 04 C0 01 02 03。

### 6.7.3 管理信息库 MIB

\(Management Information Base\)

### 6.7.4 SNMP 的协议数据单元和报文



